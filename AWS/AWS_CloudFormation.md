π’» [AWS] CloudFormation
===============
# π’΅ IaC(Infra as a Code)

* IaC(Infra as a Code) : μ½”λ“λ΅ μΈν”„λΌλ¥Ό κµ¬μ¶•, κ΄€λ¦¬ν•κΈ° μ„ν• λ„κµ¬
  * μΈν”„λΌ κµ¬μ¶•μ„ μ„ν• λ¦¬μ†μ¤λ“¤μ„ ν”„λ΅λΉ„μ €λ‹ν•κ³  κ΄€λ¦¬ν•λ”λ° μ©μ΄
* IaC λ„κµ¬μ—λ” κµ¬μ„± μ΅°μ •(Configuration Orcherstration)μ— μ΄μ μ„ λ§μ¶ ν΄κ³Ό κµ¬μ„± κ΄€λ¦¬(Configuration Management)μ— μ΄μ μ„ λ§μ¶ λ‘ κ°€μ§€ μ ν•μ ν΄μ΄ μλ”λ° CloudFormationμ€ κµ¬μ„± μ΅°μ •μ— μ΅°κΈ λ” λΉ„μ¤‘μ„ λ‘κ³  μμ
  * κµ¬μ„± μ΅°μ • ν΄μ€ μΈν”„λΌ κµ¬μ¶•μ— λΉ„μ¤‘μ„ λ‘κ³  μκ³  κµ¬μ„± κ΄€λ¦¬ ν΄μ€ μΈν”„λΌ κ΄€λ¦¬μ— λΉ„μ¤‘μ„ λ‘κ³  μμ
  * λ‘ μ ν•μ ν΄μ€ μ„λ΅ μ–΄λ μ •λ„μ κΈ°λ¥μ„ μν–‰ν•  μ μμ
  * κµ¬μ„± μ΅°μ • ν΄μ—λ” AWS CloudFormation, Terraform λ“±μ΄ μκ³  κµ¬μ„± κ΄€λ¦¬ ν΄μ—λ” Ansible λ“±μ΄ μ΅΄μ¬


# π’΅ AWS CloudFormation

* AWS CloudFormation : AWS μ κ³µν•λ” IaC λ„κµ¬
* μ½”λ“λ΅ μΈν”„λΌ κµ¬μ„±μ„ μ‘μ„±ν•κ³  μ‘μ„±ν• μΈν”„λΌλ¥Ό κµ¬μ¶•ν•κΈ° μ„ν•΄ ν•„μ”ν• AWS μ„λΉ„μ¤λ“¤μ„ ν”„λ΅λΉ„μ €λ‹ + κµ¬μ¶•
  * AWS μ›Ή μ½μ†”μ—μ„ μΈν”„λΌλ¥Ό κµ¬μ¶•ν•κ±°λ‚ μμ •ν•  λ• μΌμΌμ΄ μ†μΌλ΅ μ§μ ‘ ν΄λ¦­ν•μ§€ μ•μ•„λ„ λ¨!
* **`JSON` or `YAML`** ν¬λ§·μΌλ΅ μ‘μ„±
* CloudFormation λΉ„μ©μ€ **λ¬΄λ£**μ΄λ‚ μ¤νƒμ„ κµ¬μ„±ν•λ” λ¦¬μ†μ¤λ“¤μ λΉ„μ©μ€ λ¶€κ³Όλ¨

## π“ CloudFormation μ‘λ™ λ°©μ‹

* μΈν”„λΌμ μƒμ„±, μμ • λ° μ‚­μ κ°€ **ν…ν”λ¦Ώ(Template)** μ„ ν†µν•΄ μ§„ν–‰
* `JSON` or `YAML`λ΅ ν…ν”λ¦Ώ(μ½”λ“)μ„ μ‘μ„±
* μ‘μ„±ν• ν…ν”λ¦Ώ μ €μ¥ λ° μ‹¤ν–‰, **μ¤νƒ(Stack)** μƒμ„±
  * Local or **S3 λ²„ν‚·**μ— μ €μ¥
* μƒμ„±ν• μ¤νƒμ„ ν†µν•΄ ν”„λ΅λΉ„μ €λ‹ λ° κµ¬μ¶• μ‘μ—…

## π“ CloudFormation Resource

* Template
  * Stackμ„ κµ¬μ„±ν•  λ¦¬μ†μ¤λ¥Ό ν”„λ΅λΉ„μ €λ‹ν•κ³  κµ¬μ¶•
  * μΈν”„λΌ κµ¬μ¶•μ„ μ„ν• λ¦¬μ†μ¤λ“¤μ΄ μ„¤λ…λμ–΄ μλ” νμΌ(Parameter μ •μ)
  * `JSON` or `YAML` λ΅ μ‘μ„±λ μ½”λ“
* Stack
  * μΈν”„λΌ κµ¬μ¶•μ— ν•„μ”ν• AWS μ„λΉ„μ¤λ“¤μ„ κ΄€λ¦¬ν•  μ μλ” λ‹¨μ„
  * μ¤νƒ μƒμ„±, μ‚­μ  λ° μμ •μ„ ν†µν•΄ μΈν”„λΌ **λ³€κ²½ μ‚¬ν•­ λ°μ κ°€λ¥**
  * μ¤νƒ μ‚­μ  μ‹ λ¦¬μ†μ¤λ“¤μ΄ μ „λ¶€ μ‚­μ 
* Cloudformation
  * Stack λ³€κ²½ μ‚¬ν•­ μ²΄ν¬ λ° μ—…λ°μ΄νΈ
  * μ—λ¬ κ°μ§€ μ‹ λ΅¤λ°± μ§€μ›

## π“ Template κµ¬μ„±
* `JSON` κΈ°μ¤€μΌλ΅ μ‘μ„±

```json
{
   "AWSTemplateFormatVersion" : "version date",

   "Description" : "JSON string",

   "Metadata" : {
       
   },
   "Parameters" : {

   },
   "Rules" : {

   },
   "Mappings" : {

   },
   "Transform" : {

   },
   "Conditions" : {

   },
   "Resources" : {

   },
   "Outputs" : {

   }
}
```

* `Resources` λ¥Ό μ μ™Έν• λ‚λ¨Έμ§€λ” μµμ….
* `AWSTemplateFormatVersion` : ν…ν”λ¦Ώ λ²„μ „
* `Description` : ν…ν”λ¦Ώ μ„¤λ…
* `Metadata` : ν…ν”λ¦Ώμ— λ€ν• μ¶”κ°€ μ •λ³΄
* `Parameters` : ν…ν”λ¦Ώ μ‹¤ν–‰ μ‹ μ „λ‹¬ ν•  parameter
* `Rules` : 
* `Mappings` : ν…ν”λ¦Ώ μ‹¤ν–‰ μ‹ μ„ νƒν•κ² λλ” κ°’(νΉμ • λ¦¬μ „, AZ λ“±)
* `Conditions` : μƒμ„± μ΅°κ±΄ νλ‹¨
* `Transform` : Serverless App μ „μ©
* `Resources` **(ν•„μ)** : EC2 μΈμ¤ν„΄μ¤, S3 λ²„ν‚· λ“±μ λ¦¬μ†μ¤
* `Outputs` : ν…ν”λ¦Ώ μ‹¤ν–‰ ν›„ λ§λ“¤μ–΄μ§€λ” μμ› κ²°κ³Όκ°’(μΈμ¤ν„΄μ¤ ID, Private IP λ“±)