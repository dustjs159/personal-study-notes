ðŸ’» [Network] DNS
=========================

# ðŸ’¡ DNS(Domain Name System)

* í˜¸ìŠ¤íŠ¸ì˜ ë„ë©”ì¸ ì´ë¦„ê³¼ IPì£¼ì†Œë¥¼ ë§¤í•‘
  * ì´ë¥¼ í†µí•´ ì›¹ íŽ˜ì´ì§€ì— ì ‘ì†í•  ë•Œ IPì£¼ì†Œë¥¼ ìž…ë ¥í•˜ì§€ ì•Šê³ ë„ ë„ë©”ì¸ ì´ë¦„ì„ ìž…ë ¥í•˜ì—¬ í•´ë‹¹ ì›¹ íŽ˜ì´ì§€ IPì— ì ‘ê·¼
  * ë„ìš°ê³ ìž í•˜ëŠ” ì›¹ íŽ˜ì´ì§€, ì¦‰ ì›¹ ì„œë²„ì˜ IPë¥¼ ì¼ì¼ì´ ê¸°ì–µí•˜ê³  ìž…ë ¥í•  í•„ìš”ê°€ ì—†ìŒ
* ë„ë©”ì¸ ì´ë¦„ â†”ï¸ IP ì£¼ì†Œ ë³€í™˜ì„ ë‹´ë‹¹í•˜ëŠ” ì„œë²„ : **Name Server**
  * Name Serverì—ëŠ” **Zone File** ì´ ë“±ë¡ë˜ì–´ ìžˆìœ¼ë©° Zone Fileì€ ë„ë©”ì¸ê³¼ IP ë§¤í•‘ ì •ë³´ê°€ ì €ìž¥ë˜ì–´ ìžˆìŒ
* Port : 53

## ðŸ“Œ DNS êµ¬ì„± ìš”ì†Œ
* Domain Name Space & Resource Record
* Name Server
  * Zone File
* Resolver(í•´ì„ê¸°)

### âœ”ï¸ Domain Name Space & Resource Record
* Domain Name Space : DNSê°€ ì €ìž¥, ê´€ë¦¬í•˜ëŠ” ê³„ì¸µì  ìžë£Œêµ¬ì¡°
  * ê° ì¸µì˜ Domain Name SpaceëŠ” ë„ë©”ì¸ê³¼ ê·¸ í•˜ìœ„ ë„ë©”ì¸ì— ê´€í•œ ì •ë³´ë¥¼ íŠ¸ë¦¬êµ¬ì¡°ë¡œ ê´€ë¦¬
![DNS](https://user-images.githubusercontent.com/57285121/115060392-c5baf300-9f22-11eb-8b78-70527a4f04ba.PNG)
  * Root : TLD ì •ë³´ë§Œì„ ê°–ê³  ìžˆìœ¼ë©° ìš”ì²­ë°›ì€ ë„ë©”ì¸ì˜ TLDë¥¼ í™•ì¸í•˜ê³  í•´ë‹¹ TDL DNS ì„œë²„ì˜ ì •ë³´ë¥¼ ë°˜í™˜í•¨
    * ICANN(êµ­ì œ ì¸í„°ë„· ì£¼ì†Œ ê´€ë¦¬ ê¸°êµ¬)ì—ì„œ ê´€ë¦¬
  * TLD(Top Level Domain) : Root ë°”ë¡œ ì•„ëž˜ì— ìœ„ì¹˜í•˜ëŠ” ìµœìƒìœ„ ë„ë©”ì¸
    * gTLD(generic) : ì¡°ì§ì˜ íŠ¹ì„±ì— ë”°ë¼ êµ¬ë¶„. e.g. `.com, .info, .org `ë“±
    * ccTLD(country code) : êµ­ê°€ ì½”ë“œ. e.g. `.kr, .jp, .us` ë“±
  * ê·¸ ì•„ëž˜ ê³„ì¸µì˜ ì„œë¸Œ ë„ë©”ì¸ì€ í˜¸ìŠ¤íŒ… ì—…ì²´ê°€ ê´€ë¦¬ 
* Resource Record : Domain Name Spaceì˜ íŠ¸ë¦¬êµ¬ì¡°ì—ì„œ ê° ë…¸ë“œì— í¬í•¨ëœ ë„ë©”ì¸ì˜ Type  
  * A : IPv4 ì£¼ì†Œ   
  * AAAA : IPv6 ì£¼ì†Œ
  * CNAME(Canonical Name) : ë„ë©”ì¸ì˜ Alias
  * NS(Name Server) : ë„¤ìž„ ì„œë²„ì˜ ì—­í• ì„ ë‹¤ë¥¸ ì„œë²„ì—ê²Œ ìœ„ìž„
  * MX(Mail Exchange) : ë©”ì¼ ì„œë²„
  * SOA(Start Of Authority) : ê¶Œí•œ ì‹œìž‘ ë ˆì½”ë“œ; â†’  DNSì˜ì—­ì˜ ë©”ì¸DNSì„œë²„ë¥¼ ì •ì˜í•˜ê³  ì˜ì—­ì˜ ë³€ê²½ì‚¬í•­ì„ ê¸°ë¡í•˜ê³  ì˜ì—­ì˜ ê¸°ë³¸ TTL(Time To Live)ê°’ì„ ì •ì˜   
  

### âœ”ï¸ Name Server
* ë„ë©”ì¸ ì´ë¦„ì„ IP ì£¼ì†Œë¡œ ë³€í™˜í•˜ê¸° ìœ„í•œ ì •ë³´(Zone File)ë¥¼ ê°–ê³  ìžˆëŠ” ì„œë²„
* Zone File 
* Resolverë¡œë¶€í„° ìš”ì²­ë°›ì€ ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ IPì •ë³´ë¥¼ ë‹¤ì‹œ Resolverë¡œ ì „ë‹¬

### âœ”ï¸ Resolver(Client S/W)
* í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë„¤ìž„ ì„œë²„ë¡œ ì „ë‹¬ ë° ë„¤ìž„ ì„œë²„ë¡œë¶€í„° ë„ë©”ì¸ ì´ë¦„ê³¼ IPì£¼ì†Œë¥¼ ë°›ì•„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì œê³µ
* ë„¤ìž„ ì„œë²„ì— ìš”ì²­ì„ í–ˆì„ ë•Œ, í•´ë‹¹ ì„œë²„ì˜ ì •ë³´ê°€ ì—†ìœ¼ë©´ ë‹¤ë¥¸ ë„¤ìž„ ì„œë²„ì—ê²Œ ìš”ì²­ì„ ë³´ë‚´ ì •ë³´ë¥¼ ë°›ì•„ì˜¨ë‹¤


## ðŸ“Œ DNS ë™ìž‘ ê³¼ì •

![dns3](https://user-images.githubusercontent.com/57285121/115513296-dfab5b80-a2bd-11eb-9374-469e9c97ba1c.PNG) 

1. í´ë¼ì´ì–¸íŠ¸ëŠ” ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ì„œ ë„ë©”ì¸ì„ ìž…ë ¥í•˜ë©´ `/etc/hosts` íŒŒì¼ì—ì„œ ìž…ë ¥í•œ ë„ë©”ì¸ê³¼ ë§¤í•‘ëœ IPë¥¼ ë¨¼ì € ì°¾ê³  `/etc/hosts`ì— ë§¤í•‘ëœ ì •ë³´ê°€ ì—†ë‹¤ë©´ ISPì˜ DNS ì„œë²„ì—ê²Œ ë„ë©”ì¸ ì£¼ì†Œì— í•´ë‹¹í•˜ëŠ” IP ì£¼ì†Œë¥¼ Request

2. ISP DNS ì„œë²„ì—ì„œ ìºì‹œ ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ìºì‹œê°€ ì—†ë‹¤ë©´ Root DNS ì„œë²„ì—ê²Œ IP ì£¼ì†Œë¥¼ Request(ìºì‹œê°€ ìžˆë‹¤ë©´ 8.ë¡œ ê±´ë„ˆ ëœ€)

3. Root ì„œë²„ëŠ” ìš”ì²­ ë°›ì€ ë„ë©”ì¸ì˜ TLD(Top Level Domain)ë¥¼ í™•ì¸í•˜ê³  TLD DNS ì„œë²„ì˜ ì£¼ì†Œë¥¼ Response

4. ISP DNS ì„œë²„ëŠ” TLD DNS ì„œë²„ì—ê²Œ ë‹¤ì‹œ IP ì£¼ì†Œë¥¼ Request

5. TLD DNS ì„œë²„ëŠ” ìš”ì²­í•œ ë„ë©”ì¸ì˜ Hostnameì„ í™•ì¸í•˜ê³  í•´ë‹¹ Hostnameì„ ê´€ë¦¬í•˜ëŠ” Authoritative DNS ì„œë²„ì˜ ì£¼ì†Œë¥¼ Response

6. ISP DNS ì„œë²„ëŠ” Authoritative DNS ì„œë²„ì—ê²Œ ë˜ ë‹¤ì‹œ IP ì£¼ì†Œ Request

7. Authoritative DNS ì„œë²„ëŠ” Namespaceì— ìš”ì²­ë°›ì€ ë„ë©”ì¸ì´ ìžˆëŠ”ì§€ í™•ì¸í•˜ê³  í•´ë‹¹ ë„ë©”ì¸ì— ë§¤í•‘ëœ IP ì£¼ì†Œë¥¼ í™•ì¸í•˜ê³  Response. ë™ì‹œì— ISP DNS ì„œë²„ëŠ” í•´ë‹¹ ì •ë³´ë¥¼ ìºì‹œì— ì €ìž¥

8. ISP DNS ì„œë²„ëŠ” ë¸Œë¼ìš°ì €ì—ê²Œ IP ì£¼ì†Œ Response

9. ì›¹ ë¸Œë¼ìš°ì €ëŠ” ì „ë‹¬ ë°›ì€ IP ì£¼ì†Œë¥¼ ê°–ê³  ìžˆëŠ” í˜¸ìŠ¤íŒ… ì„œë²„ì—ê²Œ ì›¹ ì‚¬ì´íŠ¸ ì ‘ì† Request

10. ì›¹ ì‚¬ì´íŠ¸ ì ‘ì†, ì›¹ íŽ˜ì´ì§€ ì¶œë ¥

## ðŸ“Œ ê´€ë ¨ ëª…ë ¹ì–´
* `nslookup` : ë„¤ìž„ ì„œë²„ì— íŠ¹ì • ë„ë©”ì¸ì˜ IPë¥¼ ì§ˆì˜
  * `$ nslookup {domain}`
  * ëŒ€í™”í˜•ìœ¼ë¡œë„ ê°€ëŠ¥
    ```
    $ nslookup
    >
* `dig` : DNS Record ì¡°íšŒ
  * `$ dig {domain}`